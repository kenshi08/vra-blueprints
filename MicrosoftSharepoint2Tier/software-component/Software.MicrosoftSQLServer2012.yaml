'@type': "SoftwareComponentType"
createdDate: "2017-05-04T07:08:48.171Z"
lastUpdated: "2017-05-04T07:08:48.309Z"
id: "Software.MicrosoftSQLServer2012"
name: "Microsoft SQL Server 2012"
description: "Microsoft SQL Server 2012 is a relational database management system\
  \ developed by Microsoft. As a database server, it is a software product with the\
  \ primary function of storing and retrieving data as requested by other software\
  \ applications which may run either on the same computer or on another computer\
  \ across a network (including the Internet)."
publishStatus: "PUBLISHED"
publishStatusName: "Published"
schema:
  fields:
  - id: "FILE_SHARE_SQL_SERVER_2014_FOLDER"
    label: "FILE_SHARE_SQL_SERVER_2014_FOLDER"
    description: "Folder on the remote fileshare containing the SQL Server 2014 installer\
      \ binaries.e.g. SQLServer2014SP1-FullSlipstream-x64-ENU"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: "files\\sql2012\\"
    isMultiValued: false
  - id: "FILE_SHARE_USERNAME"
    label: "FILE_SHARE_USERNAME"
    description: "Username for accessing remote fileshare"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: false
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: "NULLPHASE\\cloudadmin"
    isMultiValued: false
  - id: "SQL_SVC_ACCOUNT"
    label: "SQL_SVC_ACCOUNT"
    description: "SQL Server service account (DOMAIN\\User)"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: ".\\Administrator"
    isMultiValued: false
  - id: "FILE_SHARE"
    label: "FILE_SHARE"
    description: "Remote fileshare containing installer binaries, e.g. installers-share"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: "labs"
    isMultiValued: false
  - id: "SQL_SVC_PASSWORD"
    label: "SQL_SVC_PASSWORD"
    description: "SQL Server service account password"
    dataType:
      type: "primitive"
      typeId: "SECURE_STRING"
    state:
      dependencies: []
      facets:
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "secureString"
            value: ""
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: false
      - type: "encrypted"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
    isMultiValued: false
  - id: "FILE_SHARE_PASSWORD"
    label: "FILE_SHARE_PASSWORD"
    description: "Password for remote fileshare"
    dataType:
      type: "primitive"
      typeId: "SECURE_STRING"
    state:
      dependencies: []
      facets:
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "secureString"
            value: ""
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: false
      - type: "encrypted"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
    isMultiValued: false
  - id: "FILE_SERVER"
    label: "FILE_SERVER"
    description: "IP address or Hostname of the file server e.g. smbserver.example.com"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: "depot-w7-01a.nullphase.local"
    isMultiValued: false
  - id: "host"
    label: ""
    description: ""
    dataType:
      type: "ref"
      componentTypeId: "com.vmware.csp.iaas.blueprint.service"
      classId: "Infrastructure.Machine.Schema"
      label: "Machine"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
      - type: "internal"
        value:
          type: "constantClause"
          value:
            type: "boolean"
            value: true
      - type: "visible"
        value:
          type: "constantClause"
          value:
            type: "boolean"
            value: false
    isMultiValued: false
  - id: "SQL_SYS_ADMIN_ACCOUNTS"
    label: "SQL_SYS_ADMIN_ACCOUNTS"
    description: "SQL System Admin Account"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: ".\\Administrator"
    isMultiValued: false
  - id: "MAPPED_PS_DRIVE"
    label: "MAPPED_PS_DRIVE"
    description: "PowerShell drive to which the fileshare containing the installer\
      \ binaries is mapped, e.g. 'Z'"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: "Z"
    isMultiValued: false
  - id: "SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER"
    label: "SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER"
    description: "Local folder containing SQL Server 2014 installer binaries e.g.\
      \ C:\\Temp\\Automation\\SQLServer2014SP1-FullSlipstream-x64-ENU"
    dataType:
      type: "primitive"
      typeId: "STRING"
    state:
      dependencies: []
      facets:
      - type: "mandatory"
        value:
          type: "constant"
          value:
            type: "boolean"
            value: true
      - type: "defaultValue"
        value:
          type: "constant"
          value:
            type: "string"
            value: "C:\\Temp\\Installers"
    isMultiValued: false
containerFieldId: "host"
lifecycleTasks:
- createdDate: "2017-05-04T07:08:48.175Z"
  lastUpdated: "2017-05-04T07:08:48.175Z"
  script:
    scriptContent: "# Copyright 2011-2015 VMware, Inc. All rights reserved. \n#\n\
      # ==============================================================================================\n\
      # \n# Microsoft SQL Server 2014 SP1 Blueprint v1.0\n#\n#This script is used\
      \ to install Microsoft SQL Server 2014 SP1 on a host. \n#\n# The script expects\
      \ the expanded/self-extracted installation binaries to be present on a CIFS/SMB\
      \ file share on a file server.\n# The location of the installation binaries\
      \ must be passed via properties to the script.\n#\n# INPUT PROPERTIES:\n# Property\
      \ Name Type Default Value\n#\n# The folder on the File share containing the\
      \ installer binaries.\n# FILE_SHARE_SQLSERVER_2014_FOLDER String  \n#\n# The\
      \ password of the user identity for File share access.\n# FILE_SHARE_PASSWORD\
      \ String\n#\n# The File share or CIFS/SMB mount point on the File Server containing\
      \ the installer binaries.\n# FILE_SHARE String\n#\n# The user identity used\
      \ to access the File share.\n# FILE_SHARE_USERNAME String\n#\n# The IP address\
      \ or Hostname of the File Server where the File Share containing the installer\
      \ binaries resides.\n# FILE_SERVER String\n#\n# The PowerShell drive to which\
      \ the File share containing the installer binaries is mapped.\n# MAPPED_PS_DRIVE\
      \ String \"Z\"\n#\n# Password of the user in whose identity the SQL Server service\
      \ runs.\n# SQL_SVC_PASSWORD String\n#\n# Windows account(s) to provision as\
      \ SQL Server system administrators. \n# SQL_SYSADMIN_ACCOUNTS String \".\\Administrator\"\
      \n#\n# Account for SQL Server service: Domain\\User or system account.\n# SQL_SVC_ACCOUNT\
      \ = String \".\\Administrator\"\n#\n# The local file system location to which\
      \ the installer binaries are copied from the File share. \n# SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER\
      \ String \"C:\\Temp\\Installers\"\n#\n# ==============================================================================================\n\
      \n$DebugPreference = \"Continue\"\n\n# Verify network connectivity to File server...\n\
      Test-Connection -ComputerName $FILE_SERVER -Count 1\n\n# Mount the Fileshare\
      \ on the Fileserver containing the Installer binaries\nIf ($FILE_SHARE_USERNAME)\
      \ \n{    \n    $SecurePassword = ConvertTo-SecureString \"$FILE_SHARE_PASSWORD\"\
      \ -AsPlainText -Force\n    $FileShareCredential = New-Object System.Management.Automation.PSCredential\
      \ (\"$FILE_SHARE_USERNAME\", $SecurePassword)\n    New-PSDrive –Name $MAPPED_PS_DRIVE\
      \ –PSProvider FileSystem –Root “\\\\$FILE_SERVER\\$FILE_SHARE” –Persist -Credential\
      \ $FileShareCredential\n} \nElse \n{\n    New-PSDrive –Name $MAPPED_PS_DRIVE\
      \ –PSProvider FileSystem –Root “\\\\$FILE_SERVER\\$FILE_SHARE” –Persist\n}\n\
      \n# Create destination folder for SQL Server 2014 SP1 installer binaries, if\
      \ it doesn't exist\nIf ( -Not (Test-Path $SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER)\
      \ )\n{\n    New-Item -ItemType directory -Path $SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER\n\
      }\n\n# Copy installer binaries locally from Fileshare\nTry \n{\n   Copy-Item\
      \ ${MAPPED_PS_DRIVE}:$FILE_SHARE_SQL_SERVER_2014_FOLDER  $SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER\
      \ -Recurse -ErrorAction Stop\n}\nCatch\n{\n   Write-Error \"Failed to copy SQL\
      \ Server 2014 SP1 installer binaries\"\n   Write-Error $_.Exception\n   Exit\
      \ -1 \n}\n\n# Unblock the SQL Server 2014 SP1 installer binaries\nSet-Location\
      \ $SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER -PassThru\nTry \n{\n   Get-ChildItem\
      \ -Path $SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER -Recurse | Unblock-File -confirm:$false\
      \  -ErrorAction Stop\n}\nCatch\n{\n   Write-Error \"Failed to unblock SQL Server\
      \ 2014 SP1 installer binaries\"\n   Write-Error $_.Exception\n   Exit -1 \n\
      }\n\n# Change directory to the installer folder\n# $LocalFolder = files\\sql2012\\\
      \n# $LocalFolder = sql2012\\\nSet-Location C:\\Temp\\Installers\\sql2012\n\n\
      # Set SQL Server 2014 silent installer command-line arguments\n$ListConfig=\"\
      /QUIET /ACTION=Install /FEATURES=SQL,Tools /UPDATEENABLED=0 /INSTANCENAME=MSSQLSERVER\
      \ /SQLSVCACCOUNT=\" + $Env:SQL_SVC_ACCOUNT  + \" /SQLSVCPASSWORD=\" + $Env:SQL_SVC_PASSWORD\
      \ + \" /SQLSYSADMINACCOUNTS=\" + $Env:SQL_SYS_ADMIN_ACCOUNTS + \" /IACCEPTSQLSERVERLICENSETERMS\
      \ /AGTSVCACCOUNT= \"\"NT AUTHORITY\\Network Service\"\"  /INDICATEPROGRESS\"\
      \n\n# Perform SQL Server 2014 installation\nTry \n{\n   Start-Process setup.exe\
      \ -ArgumentList $ListConfig -PassThru -Wait -ErrorAction Stop\n}\nCatch\n{\n\
      \   Write-Error \"Failed to install SQL Server 2014 SP1\"\n   Write-Error $_.Exception\n\
      \   Exit -1 \n}\n\n#End of Script"
    isRebootAfter: true
    scriptTypeId: "powershell"
  taskDescriptorRef:
    id: "INSTALL"
    label: "Install"
