id: MicrosoftSharepoint2Tier
name: Microsoft Sharepoint 2-Tier
description: Installation of Microsoft SQL Server 2012 and pre-requisites
status: PUBLISHED
properties:
  _archiveDays: 30
  _leaseDays:
    default: 5
    max: 30
    min: 5
components:
  Microsoft_.NET_Framework_4.5_1:
    type: Software.MicrosoftNETFramework45
    data:
      host:
        fixed: ${_resource~web-server}
  Microsoft_.NET_Framework_4.5_2:
    type: Software.MicrosoftNETFramework45
    data:
      host:
        fixed: ${_resource~db-server}
  Microsoft_SQL_Server_2012_1:
    type: Software.MicrosoftSQLServer2012
    dependsOn:
    - Microsoft_.NET_Framework_4.5_2
    data:
      FILE_SERVER:
        default: depot-w-01a.nullphase.local
        required: true
      FILE_SHARE:
        default: labs
        required: true
      FILE_SHARE_PASSWORD:
        default: ''
        required: false
        secured: true
      FILE_SHARE_SQL_SERVER_2014_FOLDER: files\sql2012\
      FILE_SHARE_USERNAME:
        default: NULLPHASE\cloudadmin
        required: false
      MAPPED_PS_DRIVE:
        default: Z
        required: true
      SQL_SERVER_2014_INSTALLER_BINARIES_FOLDER:
        default: C:\Temp\Installers
        required: true
      SQL_SVC_ACCOUNT:
        default: .\Administrator
        required: true
      SQL_SVC_PASSWORD:
        default: ''
        required: false
        secured: true
      SQL_SYS_ADMIN_ACCOUNTS:
        default: .\Administrator
        required: true
      host:
        fixed: ${_resource~db-server}
  Microsoft_SharePoint_2013_1:
    type: Software.MicrosoftSharePoint2013VMwareSamplebackup
    dependsOn:
    - Microsoft__Internet_Information_Server__IIS__1
    - Microsoft_SQL_Server_2012_1
    data:
      FILE_SERVER:
        default: depot-w-01a.nullphase.local
        required: true
      FILE_SHARE:
        default: labs
        required: true
      FILE_SHARE_PASSWORD:
        default: ''
        required: false
        secured: true
      FILE_SHARE_SHAREPOINT_2013_FOLDER:
        default: files\sharepoint2013\
        required: false
      FILE_SHARE_USERNAME:
        default: NULLPHASE\cloudadmin
        required: false
      MAPPED_PS_DRIVE:
        default: Z
        required: false
      PRODUCT_ID_KEY:
        default: NQTMW-K63MQ-39G6H-B2CH9-FRDWJ
        required: true
      SHAREPOINT_2013_INSTALLER_BINARIES_FOLDER:
        default: C:\Temp\Installers
        required: true
      host:
        fixed: ${_resource~web-server}
  Microsoft__Internet_Information_Server__IIS__1:
    type: Software.MicrosoftInternetInformationServerIISVMwareSamplebackup
    dependsOn:
    - Microsoft_.NET_Framework_4.5_1
    data:
      host:
        fixed: ${_resource~web-server}
  PayloadClusterExt:
    type: Infrastructure.Network.Network.Existing
    data:
      name:
        fixed: PayloadClusterExt
      network_profile:
        fixed: PayloadCluster-Ext
  db-server:
    type: Infrastructure.CatalogItem.Machine.Virtual.vSphere
    data:
      _cluster:
        default: 1
        max: 1
        min: 1
      action:
        fixed: LinkedClone
      allow_storage_policies:
        fixed: false
      blueprint_type:
        fixed: '1'
      cpu:
        default: 1
        max: 2
        min: 1
      description: W2K12 - DB
      disks:
      - capacity: 60
        custom_properties: null
        id: 1493999748052
        initial_location: ''
        is_clone: true
        label: Hard disk 1
        storage_reservation_policy: ''
        userCreated: false
        volumeId: 0
      guest_customization_specification: win-cust
      max_network_adapters: {}
      max_volumes: {}
      memory:
        default: 1024
        max: 2048
        min: 1024
      nics:
      - address: ''
        assignment_type: Static
        id: 0
        load_balancing: ''
        network: ${_resource~PayloadClusterExt}
        network_profile: PayloadCluster-Ext
      provisioning_workflow:
        fixed:
          id: CloneWorkflow
          label: CloneWorkflow
      security_groups: []
      security_tags: []
      snapshot_name:
        fixed: vRA-Base-SS-01
      source_machine:
        fixed:
          id: a518f48a-1184-404c-85c6-2fc91e60021f
          label: vRA-W2K12
      source_machine_external_snapshot:
        fixed: 1
      source_machine_name:
        fixed: vRA-W2K12
      source_machine_vmsnapshot:
        fixed:
          id: '4'
      storage:
        default: 60
        max: 150
        min: 60
  web-server:
    type: Infrastructure.CatalogItem.Machine.Virtual.vSphere
    data:
      _cluster:
        default: 1
        max: 1
        min: 1
      action:
        fixed: LinkedClone
      allow_storage_policies:
        fixed: false
      blueprint_type:
        fixed: '1'
      cpu:
        default: 1
        max: 2
        min: 1
      description: W2K12 - Web
      disks:
      - capacity: 60
        custom_properties: null
        id: 1493999736397
        initial_location: ''
        is_clone: true
        label: Hard disk 1
        storage_reservation_policy: ''
        userCreated: false
        volumeId: 0
      guest_customization_specification: win-cust
      max_network_adapters: {}
      max_volumes: {}
      memory:
        default: 1024
        max: 2048
        min: 1024
      nics:
      - address: ''
        assignment_type: Static
        id: 0
        load_balancing: ''
        network: ${_resource~PayloadClusterExt}
        network_profile: PayloadCluster-Ext
      provisioning_workflow:
        fixed:
          id: CloneWorkflow
          label: CloneWorkflow
      security_groups: []
      security_tags: []
      snapshot_name:
        fixed: vRA-Base-SS-01
      source_machine:
        fixed:
          id: a518f48a-1184-404c-85c6-2fc91e60021f
          label: vRA-W2K12
      source_machine_external_snapshot:
        fixed: 1
      source_machine_name:
        fixed: vRA-W2K12
      source_machine_vmsnapshot:
        fixed:
          id: '4'
      storage:
        default: 60
        max: 150
        min: 60
layout:
  Microsoft_.NET_Framework_4.5_1: 2,0
  Microsoft_.NET_Framework_4.5_2: 1,0
  Microsoft_SQL_Server_2012_1: 0,0
  Microsoft_SharePoint_2013_1: 0,0
  Microsoft__Internet_Information_Server__IIS__1: 1,0
  PayloadClusterExt: 1,0
  db-server: 0,1
  web-server: 0,0
